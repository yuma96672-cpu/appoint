[{"filePath":"C:\\Users\\magur\\Downloads\\github\\appoint\\eslint.config.mjs","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\magur\\Downloads\\github\\appoint\\next.config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\magur\\Downloads\\github\\appoint\\postcss.config.mjs","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\magur\\Downloads\\github\\appoint\\src\\app\\layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\magur\\Downloads\\github\\appoint\\src\\app\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\magur\\Downloads\\github\\appoint\\src\\app\\tetris\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\magur\\Downloads\\github\\appoint\\src\\components\\tetris\\Cell.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\magur\\Downloads\\github\\appoint\\src\\components\\tetris\\Display.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\magur\\Downloads\\github\\appoint\\src\\components\\tetris\\Stage.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\magur\\Downloads\\github\\appoint\\src\\components\\tetris\\StartButton.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\magur\\Downloads\\github\\appoint\\src\\components\\tetris\\Tetris.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'setPlayer' is assigned a value but never used.","line":18,"column":65,"nodeType":"Identifier","messageId":"unusedVar","endLine":18,"endColumn":74}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport React, { useState } from 'react';\r\nimport { createStage, checkCollision } from '@/utils/tetris/gameHelpers';\r\nimport { useInterval } from '@/hooks/tetris/useInterval';\r\nimport { usePlayer } from '@/hooks/tetris/usePlayer';\r\nimport { useStage } from '@/hooks/tetris/useStage';\r\nimport { useGameStatus } from '@/hooks/tetris/useGameStatus';\r\n\r\nimport Stage from './Stage';\r\nimport Display from './Display';\r\nimport StartButton from './StartButton';\r\n\r\nconst Tetris: React.FC = () => {\r\n    const [dropTime, setDropTime] = useState<number | null>(null);\r\n    const [gameOver, setGameOver] = useState(false);\r\n\r\n    const { player, updatePlayerPos, resetPlayer, playerRotate, setPlayer } = usePlayer();\r\n    const { stage, setStage, rowsCleared } = useStage(player, resetPlayer);\r\n    const { score, setScore, rows, setRows, level, setLevel } = useGameStatus(rowsCleared);\r\n\r\n    const movePlayer = (dir: number) => {\r\n        if (!checkCollision(player, stage, { x: dir, y: 0 })) {\r\n            updatePlayerPos({ x: dir, y: 0, collided: false });\r\n        }\r\n    };\r\n\r\n    const startGame = () => {\r\n        // Reset everything\r\n        setStage(createStage());\r\n        setDropTime(1000);\r\n        resetPlayer();\r\n        setGameOver(false);\r\n        setScore(0);\r\n        setRows(0);\r\n        setLevel(0);\r\n    };\r\n\r\n    const drop = () => {\r\n        // Increase level when player has cleared 10 rows\r\n        if (rows > (level + 1) * 10) {\r\n            setLevel((prev) => prev + 1);\r\n            // Also increase speed\r\n            setDropTime(1000 / (level + 1) + 200);\r\n        }\r\n\r\n        if (!checkCollision(player, stage, { x: 0, y: 1 })) {\r\n            updatePlayerPos({ x: 0, y: 1, collided: false });\r\n        } else {\r\n            // Game Over\r\n            if (player.pos.y < 1) {\r\n                setGameOver(true);\r\n                setDropTime(null);\r\n            }\r\n            updatePlayerPos({ x: 0, y: 0, collided: true });\r\n        }\r\n    };\r\n\r\n    const keyUp = ({ keyCode }: { keyCode: number }) => {\r\n        if (!gameOver) {\r\n            if (keyCode === 40) { // Down arrow\r\n                setDropTime(1000 / (level + 1) + 200);\r\n            }\r\n        }\r\n    };\r\n\r\n    const dropPlayer = () => {\r\n        setDropTime(null);\r\n        drop();\r\n    };\r\n\r\n    const move = ({ keyCode }: { keyCode: number }) => {\r\n        if (!gameOver) {\r\n            if (keyCode === 37) { // Left\r\n                movePlayer(-1);\r\n            } else if (keyCode === 39) { // Right\r\n                movePlayer(1);\r\n            } else if (keyCode === 40) { // Down\r\n                dropPlayer();\r\n            } else if (keyCode === 38) { // Up\r\n                playerRotate(stage, 1);\r\n            }\r\n        }\r\n    };\r\n\r\n    useInterval(() => {\r\n        drop();\r\n    }, dropTime);\r\n\r\n    return (\r\n        <div\r\n            className=\"flex flex-col md:flex-row items-start justify-center gap-8 w-full max-w-4xl mx-auto p-4 outline-none\"\r\n            role=\"button\"\r\n            tabIndex={0}\r\n            onKeyDown={(e) => move(e)}\r\n            onKeyUp={keyUp}\r\n            ref={(div) => {\r\n                // Auto-focus on mount so keyboard works immediately\r\n                div?.focus();\r\n            }}\r\n        >\r\n            <div className=\"flex-1 max-w-[500px] w-full aspect-[12/20]\">\r\n                <Stage stage={stage} />\r\n            </div>\r\n\r\n            <div className=\"flex flex-col w-full max-w-[200px] gap-4\">\r\n                {gameOver ? (\r\n                    <Display gameOver={gameOver} text=\"Game Over\" />\r\n                ) : (\r\n                    <>\r\n                        <Display text={`Score: ${score}`} />\r\n                        <Display text={`Rows: ${rows}`} />\r\n                        <Display text={`Level: ${level}`} />\r\n                    </>\r\n                )}\r\n                <StartButton callback={startGame} />\r\n\r\n                <div className=\"mt-8 text-white/50 text-sm\">\r\n                    <p>Controls:</p>\r\n                    <ul className=\"list-disc pl-5 mt-2 space-y-1\">\r\n                        <li>⬅️ Move Left</li>\r\n                        <li>➡️ Move Right</li>\r\n                        <li>⬆️ Rotate</li>\r\n                        <li>⬇️ Speed Up</li>\r\n                    </ul>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default Tetris;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\magur\\Downloads\\github\\appoint\\src\\hooks\\tetris\\useGameStatus.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useCallback' is defined but never used.","line":1,"column":31,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":42,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"useCallback"},"fix":{"range":[28,41],"text":""},"desc":"Remove unused variable \"useCallback\"."}]},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\magur\\Downloads\\github\\appoint\\src\\hooks\\tetris\\useGameStatus.ts:16:13\n  14 |\n  15 |         if (rowsCleared > 0) {\n> 16 |             setScore((prev) => prev + calculateScore(rowsCleared, level));\n     |             ^^^^^^^^ Avoid calling setState() directly within an effect\n  17 |             setRows((prev) => prev + rowsCleared);\n  18 |             setLevel((prev) => prev + 1);\n  19 |         }","line":16,"column":13,"nodeType":null,"endLine":16,"endColumn":21}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useCallback } from 'react';\r\n\r\nexport const useGameStatus = (rowsCleared: number) => {\r\n    const [score, setScore] = useState(0);\r\n    const [rows, setRows] = useState(0);\r\n    const [level, setLevel] = useState(0);\r\n\r\n    useEffect(() => {\r\n        const calculateScore = (rowsClearedArg: number, levelArg: number) => {\r\n            const linePoints = [40, 100, 300, 1200];\r\n            // We start at level 0, so level + 1 gives us the multiplier\r\n            return linePoints[rowsClearedArg - 1] * (levelArg + 1);\r\n        }\r\n\r\n        if (rowsCleared > 0) {\r\n            setScore((prev) => prev + calculateScore(rowsCleared, level));\r\n            setRows((prev) => prev + rowsCleared);\r\n            setLevel((prev) => prev + 1);\r\n        }\r\n    }, [rowsCleared, level]);\r\n\r\n    return { score, setScore, rows, setRows, level, setLevel };\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\magur\\Downloads\\github\\appoint\\src\\hooks\\tetris\\useInterval.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\magur\\Downloads\\github\\appoint\\src\\hooks\\tetris\\usePlayer.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":23,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":23,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[886,889],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[886,889],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useCallback } from 'react';\r\nimport { TETROMINOS, randomTetromino, TetrominoShape } from '@/utils/tetris/tetrominos';\r\nimport { STAGE_WIDTH, checkCollision } from '@/utils/tetris/gameHelpers';\r\nimport { Player } from '@/utils/tetris/types';\r\n\r\nexport const usePlayer = () => {\r\n    const [player, setPlayer] = useState<Player>({\r\n        pos: { x: 0, y: 0 },\r\n        tetromino: TETROMINOS[0].shape,\r\n        collided: false,\r\n    });\r\n\r\n    const rotate = (matrix: TetrominoShape, dir: number) => {\r\n        // Transpose rows to cols\r\n        const rotatedTetromino = matrix.map((_, index) =>\r\n            matrix.map((col) => col[index])\r\n        );\r\n        // Reverse each row to get a rotated matrix\r\n        if (dir > 0) return rotatedTetromino.map((row) => row.reverse());\r\n        return rotatedTetromino.reverse();\r\n    };\r\n\r\n    const playerRotate = (stage: any[], dir: number) => {\r\n        const clonedPlayer = JSON.parse(JSON.stringify(player));\r\n        clonedPlayer.tetromino.shape = rotate(clonedPlayer.tetromino.shape, dir);\r\n\r\n        const pos = clonedPlayer.pos.x;\r\n        let offset = 1;\r\n\r\n        while (checkCollision(clonedPlayer, stage, { x: 0, y: 0 })) {\r\n            clonedPlayer.pos.x += offset;\r\n            offset = -(offset + (offset > 0 ? 1 : -1));\r\n            if (offset > clonedPlayer.tetromino.shape[0].length) {\r\n                rotate(clonedPlayer.tetromino.shape, -dir);\r\n                clonedPlayer.pos.x = pos;\r\n                return;\r\n            }\r\n        }\r\n        setPlayer(clonedPlayer);\r\n    };\r\n\r\n    const updatePlayerPos = ({ x, y, collided }: { x: number; y: number; collided: boolean }) => {\r\n        setPlayer((prev) => ({\r\n            ...prev,\r\n            pos: { x: (prev.pos.x += x), y: (prev.pos.y += y) },\r\n            collided,\r\n        }));\r\n    };\r\n\r\n    const resetPlayer = useCallback(() => {\r\n        setPlayer({\r\n            pos: { x: STAGE_WIDTH / 2 - 2, y: 0 },\r\n            tetromino: randomTetromino(),\r\n            collided: false,\r\n        });\r\n    }, []);\r\n\r\n    return { player, updatePlayerPos, resetPlayer, playerRotate, setPlayer };\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\magur\\Downloads\\github\\appoint\\src\\hooks\\tetris\\useStage.ts","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\magur\\Downloads\\github\\appoint\\src\\hooks\\tetris\\useStage.ts:10:9\n   8 |\n   9 |     useEffect(() => {\n> 10 |         setRowsCleared(0);\n     |         ^^^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  11 |\n  12 |         const updateStage = (prevStage: any[]) => {\n  13 |             // First flush the stage from the previous render","line":10,"column":9,"nodeType":null,"endLine":10,"endColumn":23},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":12,"column":41,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":12,"endColumn":44,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[434,437],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[434,437],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":15,"column":32,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":15,"endColumn":35,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[594,597],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[594,597],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":38,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":38,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1525,1528],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1525,1528],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":40,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":40,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1638,1641],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1638,1641],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\r\nimport { createStage } from '@/utils/tetris/gameHelpers';\r\nimport { Player } from '@/utils/tetris/types';\r\n\r\nexport const useStage = (player: Player, resetPlayer: () => void) => {\r\n    const [stage, setStage] = useState(createStage());\r\n    const [rowsCleared, setRowsCleared] = useState(0);\r\n\r\n    useEffect(() => {\r\n        setRowsCleared(0);\r\n\r\n        const updateStage = (prevStage: any[]) => {\r\n            // First flush the stage from the previous render\r\n            const newStage = prevStage.map((row) =>\r\n                row.map((cell: any[]) => (cell[1] === 'clear' ? [0, 'clear'] : cell))\r\n            );\r\n\r\n            // Then draw the simplified tetromino\r\n            player.tetromino.shape.forEach((row, y) => {\r\n                row.forEach((value, x) => {\r\n                    if (value !== 0) {\r\n                        if (\r\n                            newStage[y + player.pos.y] &&\r\n                            newStage[y + player.pos.y][x + player.pos.x]\r\n                        ) {\r\n                            newStage[y + player.pos.y][x + player.pos.x] = [\r\n                                value,\r\n                                `${player.collided ? 'merged' : 'clear'}`,\r\n                            ];\r\n                        }\r\n                    }\r\n                });\r\n            });\r\n\r\n            // Then check if it collided\r\n            if (player.collided) {\r\n                resetPlayer();\r\n                const sweepRows = (newStage: any[]) =>\r\n                    newStage.reduce((ack, row) => {\r\n                        if (row.findIndex((cell: any[]) => cell[0] === 0) === -1) {\r\n                            setRowsCleared((prev) => prev + 1);\r\n                            ack.unshift(new Array(newStage[0].length).fill([0, 'clear']));\r\n                            return ack;\r\n                        }\r\n                        ack.push(row);\r\n                        return ack;\r\n                    }, []);\r\n                return sweepRows(newStage);\r\n            }\r\n\r\n            return newStage;\r\n        };\r\n\r\n        setStage((prev) => updateStage(prev));\r\n    }, [player, resetPlayer]);\r\n\r\n    return { stage, setStage, rowsCleared };\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\magur\\Downloads\\github\\appoint\\src\\utils\\tetris\\gameHelpers.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":13,"column":12,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":13,"endColumn":15,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[307,310],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[307,310],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Player } from './types';\r\n\r\nexport const STAGE_WIDTH = 12;\r\nexport const STAGE_HEIGHT = 20;\r\n\r\nexport const createStage = () =>\r\n    Array.from(Array(STAGE_HEIGHT), () =>\r\n        new Array(STAGE_WIDTH).fill([0, 'clear'])\r\n    );\r\n\r\nexport const checkCollision = (\r\n    player: Player,\r\n    stage: any[],\r\n    { x: moveX, y: moveY }: { x: number; y: number }\r\n) => {\r\n    for (let y = 0; y < player.tetromino.shape.length; y += 1) {\r\n        for (let x = 0; x < player.tetromino.shape[y].length; x += 1) {\r\n            // 1. Check that we're on an actual Tetromino cell\r\n            if (player.tetromino.shape[y][x] !== 0) {\r\n                if (\r\n                    // 2. Check that our move is inside the game areas height (y)\r\n                    // We shouldn't go through the bottom of the play area\r\n                    !stage[y + player.pos.y + moveY] ||\r\n                    // 3. Check that our move is inside the game areas width (x)\r\n                    !stage[y + player.pos.y + moveY][x + player.pos.x + moveX] ||\r\n                    // 4. Check that the cell we're moving to isn't set to clear\r\n                    stage[y + player.pos.y + moveY][x + player.pos.x + moveX][1] !==\r\n                    'clear'\r\n                ) {\r\n                    return true;\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return false;\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\magur\\Downloads\\github\\appoint\\src\\utils\\tetris\\tetrominos.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\magur\\Downloads\\github\\appoint\\src\\utils\\tetris\\types.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]}]